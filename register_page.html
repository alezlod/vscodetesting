<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>建立帳號</title>
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="font-awesome/css/all.min.css">
    <link rel="stylesheet" href="css/animate.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Lobster+Two:wght@700&family=Passion+One&display=swap');

        .carousel-caption {
            top: 0px;
            bottom: 0px;
        }

        ;

        @import url('https://fonts.googleapis.com/css2?family=Lobster+Two:wght@700&display=swap');
    </style>
</head>

<body>
    <script src="https://cdn.lordicon.com/fudrjiwc.js"></script>
    <script src="js/bootstrap.bundle.min.js"></script>
    <!-- 1: carousel ads -->
    <div id="carouselExampleIndicators" class="carousel slide" data-bs-ride="carousel">
        <div class="carousel-inner">
            <div class="carousel-item active">
                <img src="https://images.unsplash.com/photo-1588421357574-87938a86fa28?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1470&q=80"
                    style="height:100px" class="d-block w-100" alt="...">
                <div class="carousel-caption d-none d-md-block">
                    <a href="#"
                        style="color:white; font-size: x-large;text-decoration: none;font-family:Passion One;font-size: 55px; margin-top: 3;">FREE
                        SHIPPING ON ALL ORDERS!</a>
                </div>
            </div>
            <div class="carousel-item">
                <img src="https://images.unsplash.com/photo-1557682260-96773eb01377?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1129&q=80"
                    style="height:100px" class="d-block w-100" alt="...">
                <div class="carousel-caption d-none d-md-block px-3">
                    <a href="#"
                        style="color:white; font-size: x-large;text-decoration: none;font-family:Passion One;font-size: 55px; margin-top: 3;">2023
                        SPRING NEW COLLECTIONS!</a>
                </div>
            </div>
            <div class="carousel-item">
                <img src="https://images.unsplash.com/photo-1557682250-33bd709cbe85?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1129&q=80"
                    style="height:100px" class="d-block w-100" alt="...">
                <div class="carousel-caption d-none d-md-block px-3">
                    <a href="#"
                        style="color:white; font-size: x-large;text-decoration: none;font-family:Passion One;font-size: 55px; margin-top: 3;">SURFING
                        DAY AT KA'UAI</a>
                </div>
            </div>
        </div>
        <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleIndicators"
            data-bs-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Previous</span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleIndicators"
            data-bs-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Next</span>
        </button>
    </div>
    <!-- 2: banner -->
    <section>
        <div class="text-end">
            <div class="container">
                <a href="#" style="text-decoration:none; font-family:Passion One; color:black; font-size:20px;">TEAM
                    SALES</a>
                <a href="#"
                    style="text-decoration:none; font-family:Passion One;color:black; font-size:20px;">EVENTS</a>
            </div>

        </div>
    </section>

    <!-- 3: navbar1 -->
    <section>
        <nav class="navbar navbar-expand-lg bg-body-tertiary">
            <div class="container-fluid">
                <a class="navbar-brand" href="#">
                    <div class="box" style="background-color:#ff6f69; padding: 10px;">
                        <h1 style="font-family: Lobster Two; color:white">naru</h1>
                    </div>
                </a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                    data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
                    aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarSupportedContent">
                    <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                        <li class="nav-item dropdown">
                            <a class="" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false"
                                style="text-decoration: none;">
                                <div class="box" style="padding:10px">
                                    <h3 style="font-family: Passion One; color: #ff6f69; font-size:35px">SWIMSUIT</h3>
                                </div>
                            </a>
                            <ul class="dropdown-menu">
                                <li><a class="dropdown-item" href="#">One Piece</a></li>
                                <li><a class="dropdown-item" href="#">Bikini Tops</a></li>
                                <li><a class="dropdown-item" href="#">Bikini Buttoms</a></li>
                                <li>
                                    <hr class="dropdown-divider">
                                </li>
                                <li><a class="dropdown-item" href="#">All Swimsuit</a></li>
                            </ul>
                        </li>
                        <li class="nav-item dropdown">
                            <a class="" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false"
                                style="text-decoration: none;"></a>
                            <div class="box" style="padding:10px">
                                <h3 style="font-family: Passion One; color: #ff6f69; font-size:35px">LIMITED EDITION
                                    PRINT</h3>
                            </div>
                            </a>
                            <ul class="dropdown-menu">
                                <li><a class="dropdown-item" href="#">滑雪裝備</a></li>
                                <li><a class="dropdown-item" href="#">私人教練</a></li>
                                <li>
                                    <hr class="dropdown-divider">
                                </li>
                                <li><a class="dropdown-item" href="#">其他服務</a></li>
                            </ul>
                        </li>
                        <li class="nav-item dropdown">
                            <a class="" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false"
                                style="text-decoration: none;"></a>
                            <div class="box" style="padding:10px">
                                <h3 style="font-family: Passion One; color: #ff6f69; font-size:35px">CLOTHING</h3>
                            </div>
                            </a>
                            <ul class="dropdown-menu">
                                <li><a class="dropdown-item" href="#">滑雪裝備</a></li>
                                <li><a class="dropdown-item" href="#">私人教練</a></li>
                                <li>
                                    <hr class="dropdown-divider">
                                </li>
                                <li><a class="dropdown-item" href="#">其他服務</a></li>
                            </ul>
                        </li>
                        <li class="nav-item" id="link-control" style="display:none;">
                            <a class="nav-link" href="members_management.html" style="color:white">後臺管理</a>
                        </li>
                    </ul>
                    <section>
                        <div class="text-end">
                            <a class="button" href="login_page.html" role="button"><i
                                    class="fa-solid fa-magnifying-glass fa-2xl"></i></a></button>
                            <button class="btn"><i class="fa-regular fa-user fa-2xl"></i></button>
                            <button class="btn"><i class="fa-solid fa-cart-shopping fa-2xl"></i></button>
                        </div>
                    </section>
                </div>
            </div>
        </nav>
    </section>

    <!-- 4. center -->
    <section>
        <div class="card w-100"
            style="background-image: url(https://images.unsplash.com/photo-1484291470158-b8f8d608850d?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1170&q=80); background-repeat:no-repeat; background-size: cover;">
            <div class="card-body">
                <div class="card-title"
                    style="text-align: center;text-decoration: none; font-size:80px; font-weight:900; color: white">建立帳號
                </div>
                <div class="col-4 offset-4">
                    <div class="input-group input-group-lg">
                        <span class="input-group-text" id="inputGroup-sizing-lg" style="font-size: 25px;">帳號</span>
                        <input type="text" class="form-control" aria-label="Sizing example input"
                            aria-describedby="inputGroup-sizing-lg" id="username" required="">
                        <!-- 以下這兩行是當input值正確時顯示的提醒 -->
                        <div class="invalid-feedback" id="reg_invalid-feedback">帳號字數8-15</div>
                        <div class="valid-feedback" id="reg_valid-feedback">可使用帳號</div>
                    </div>
                    <div class="input-group input-group-lg mt-3">
                        <span class="input-group-text" id="inputGroup-sizing-lg" style="font-size: 25px;">密碼</span>
                        <input type="password" class="form-control" aria-label="Sizing example input"
                            aria-describedby="inputGroup-sizing-lg" id="password">
                        <!-- 以下這兩行是當input值正確時顯示的提醒 -->
                        <div class="invalid-feedback">密碼字數6-15</div>
                        <div class="valid-feedback">密碼正確</div>
                    </div>
                    <div class="input-group input-group-lg mt-3">
                        <span class="input-group-text" id="inputGroup-sizing-lg" style="font-size: 25px;">確認密碼</span>
                        <input type="password" class="form-control" aria-label="Sizing example input"
                            aria-describedby="inputGroup-sizing-lg" id="repassword">
                        <div class="invalid-feedback" id="err_reg_re_password">密碼確認不符</div>
                        <div class="valid-feedback" id="err_reg_re_password">OK!</div>
                    </div>
                    <div class="input-group input-group-lg mt-3">
                        <span class="input-group-text" id="inputGroup-sizing-lg" style="font-size: 25px;">信箱</span>
                        <input type="email" class="form-control" aria-label="Sizing example input"
                            aria-describedby="inputGroup-sizing-lg" id="email">
                        <div class="invalid-feedback" id="verify_email">信箱已註冊過</div>
                        <div class="valid-feedback" id="verify_email">信箱可使用</div>
                    </div>
                    <div class="input-group input-group-lg mt-3">
                        <span class="input-group-text" id="inputGroup-sizing-lg" style="font-size: 25px;">居住地</span>
                        <input type="text" class="form-control" aria-label="Sizing example input"
                            aria-describedby="inputGroup-sizing-lg" id="location">
                        <div class="invalid-feedback">填寫居住地</div>
                        <div class="valid-feedback"></div>

                    </div>
                    <div class="col-6 offset-3">
                        <div class="form-check mt-3">
                            <input type="checkbox" id="subscription" name="subscription" class="form-check-input"
                                value="true">
                            <label for="subscription" class="form-check-label">訂閱NARU電子雜誌</label>
                        </div>
                        <button class="btn btn-primary" id="register_btn">註冊
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- 7: grey information area -->
    <section>
        <div class="row" style="background-color:#D3D3D3">
            <div class="container mt-3 p-5">
                <h1 style="text-align:center;font-weight:900;">Lorem, ipsum dolor sit amet c</h1>
                <h3 style="text-align:center">Lorem ipsum dolor, sit amet consectetur adipisicing elit. Deserunt
                    deleniti repellat voluptatem fugiat veritatis rem ab ratione quo repudiandae omnis placeat, aliquam
                    reiciendis Lorem ipsum dolor, sit amet consectetur adipisicing elit. Eligendi quis quam ipsam aut
                    cupiditate vero pariatur facilis inventore dicta recusandae.<br><br></h3>
                <a href="#" style="text-align: center; color:black">
                    <h3>LEARN MORE</h3>
                </a>
            </div>
        </div>
    </section>
    <!-- 8: bottom -->
    <section class="" style="background-color:#ff6f69">
        <div class="container" style="color:white">
            <div class="row">
                <div class="d-flex justify-content-start">
                    <div class="col-md-4 text-center">
                        <div class="fs-3 mt-5">Get our updates in your inbox.</div>
                        <div class="box mt-1" style="background-color:black; height:5px;"></div>
                        <p class="mt-3">* By completing this form you are signing up to receive our emails and can
                            unsubscribe at any time.</p>
                    </div>
                    <div class="d-flex align-item-center justify-content-end">
                        <div class="col-md-4 text-center">
                            <div class="fs-4">Company</div>
                            <a href="#">About us</a>
                            <a href="#">Blog</a>
                            <a href="#">Event</a>
                        </div>
                    </div>
                    <div class="d-flex align-item-center justify-content-end">
                        <div class="col-md-4 text-center">
                            <div class="fs-4">Support</div>
                            <a href="#">Contact us</a>
                            <a href="#">FAQ</a>
                            <a href="#">RETURN</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <script src="js/jquery-3.6.1.min.js"></script>
    <script src="js/bootstrap.bundle.min.js"></script>
    <script>
        $(function () {
            //set up flags

            var flag_username = false;
            var flag_password = false;
            var flag_repassword = false;
            var flag_email = false;
            var flag_location = false;

            // 帳號1. 字數偵測 2. 帳號是否註冊過(與DB資料對照)
            $("#username").bind("input propertychange", function () {
                if ($(this).val().length >= 5 && $(this).val().length <= 15) {
                    var jsonData = {};
                    jsonData["username"] = $(this).val();
                    $.ajax({
                        type: "POST",
                        url: "mem_reg_check_api.php",
                        dataType: "json",
                        data: JSON.stringify(jsonData),
                        success: showdata_check_one,
                        error: function () {
                            alert("error-mem_reg_check_api.php");
                        }
                    });
                    // $("#reg_valid-feedback").text("帳號輸入正確");
                    $("#username").removeClass("is-invalid");
                    $("#username").addClass("is-valid");
                    flag_username = true;
                } else {
                    //不符合規則
                    $("#reg_invalid-feedback").text("帳號字數5-15");
                    $("#username").removeClass("is-valid");
                    $("#username").addClass("is-invalid");
                    flag_username = false;
                }
            })
            // 密碼1. 字數偵測 
            // 先去試試valid和invalid的東西
            $("#password").bind("input propertychange", function () {
                if ($(this).val().length > 5 && $(this).val().length <= 15) {
                    if ($(this).val().length >= 5 && $(this).val().length <= 15) {
                        // 如何偵測大小寫
                        if ($(this).val().search(/[a-z]/) > 0) {
                            if ($(this).val().search(/[A-Z]/) > 0) {
                                if ($(this).val().search([0 - 9]) > 0) {
                                    $("#password").addClass("is-valid");
                                    $("#password").removeClass("is-invalid");
                                    flag_password = true;
                                } else {
                                    $("#password").addClass("is-invalid");
                                    $("#password").removeClass("is-valid");
                                    flag_password = false;
                                }
                            } else {
                                $("#password").addClass("is-invalid");
                                $("#password").removeClass("is-valid");
                                flag_password = false;
                            }
                        } else {
                            $("#password").addClass("is-invalid");
                            $("#password").removeClass("is-valid");
                            flag_password = false;
                        }
                    } else {
                        $("#password").addClass("is-invalid");
                        $("#password").removeClass("is-valid");
                        flag_password = false;
                    }
                } else {
                    $("#password").addClass("is-invalid");
                    $("#password").removeClass("is-valid");
                    flag_password = false;
                }
            });
            // 判定密碼確認欄位與上一行的input相同
            $("#repassword").bind("input propertychange", function () {
                if ($(this).val() == $("#password").val()) {
                    $("#repassword").addClass("is-valid");
                    $("#repassword").removeClass("is-invalid");
                    flag_repassword = true;
                } else {
                    $("#repassword").addClass("is-invalid");
                    $("#repassword").removeClass("is-valid");
                    flag_repassword = false;
                }
            });

            //判定email是否有註冊過
            $("#email").bind("input propertychange", function () {
                var jsonData = {};
                jsonData["email"] = $("#email").val();
                $.ajax({
                    type: "POST",
                    url: "register_email_verify.php",
                    data: JSON.stringify(jsonData),
                    dataType: "json",
                    success: email_verify,
                    error: function () {
                        alert("error.register_email_verify.php")
                    }
                })

            });

            $("#location").bind("input propertychange", function () {
                if ($(this).val().length > 0) {
                    $("#location").addClass("is-valid");
                    $("#location").removeClass("is-invalid");
                    flag_location = true;

                } else {
                    $("#location").addClass("is-invalid");
                    $("#location").removeClass("is-valid");
                    flag_location = false;
                }
            });

            $("#subscription").bind("input propertychange", function () {
                var check01 = [];
                $.each($("input[name='subscription']:checked"), function () {
                    check01.push($(this).val());
                });
                console.log(check01);
                if (check01.length == 1) {
                    console.log("subscribed");
                } else {
                    console.log("unsubscribed");
                }
            })

            $("#register_btn").bind("click", function () {
                if (flag_username) {
                    //判定flag是否true
                    var jsonData = {};
                    jsonData["username"] = $("#username").val();
                    jsonData["password"] = $("#password").val();
                    jsonData["email"] = $("#email").val();
                    jsonData["location"] = $("#location").val();
                    // jsonData["subscription"] = $("#subscription").val();
                    jsonData["userstate"] = "y";
                    if ($("#subscription").val()) {
                        jsonData["subscription"] = '1';
                    } else {
                        jsonData["subscription"] = '0';
                    }
                    $.ajax({
                        type: "POST",
                        url: "member_add_api.php",
                        data: JSON.stringify(jsonData),
                        dataType: "json",
                        success: register_memebers,
                        error: function () {
                            alert("error_member_add_api.php");
                        }
                    })
                } else {
                    alert("會員資料不完整");
                }
            });
        })

        function showdata_check_one(data) {
            console.log(data);
            if (data.state) {
                //non-existing username
                $("#reg_valid-feedback").text("該帳號不存在, 帳號可以使用!");
                $("#reg_username").removeClass("is-invalid");
                $("#reg_username").addClass("is-valid");
                flag_username = true;
            } else {
                // existing username
                $("#reg_invalid-feedback").text("該帳號已存在, 帳號不可以使用!");
                $("#reg_username").removeClass("is-valid");
                $("#reg_username").addClass("is-invalid");
                flag_username = false;
            }
        }

        function email_verify(data) {
            if (data.state) {
                $("#email").addClass("is-valid");
                $("#email").removeClass("is-invalid");
                flag_email = true;
            } else {
                $("#email").addClass("is-invalid");
                $("#email").removeClass("is-valid");
                flag_email = false;
            }
        }

        function register_memebers(data) {
            if (data.state) {
                alert(data.message);
                location.href = "swimwear_homepage.html"
            } else {
                alert(data.message);
            }
        }
    </script>
</body>

</html>